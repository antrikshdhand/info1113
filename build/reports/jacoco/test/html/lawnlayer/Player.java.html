<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Player.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">lawnlayer</a> &gt; <a href="index.source.html" class="el_package">lawnlayer</a> &gt; <span class="el_source">Player.java</span></div><h1>Player.java</h1><pre class="source lang-java linenums">package lawnlayer;

import processing.core.PImage;

public class Player extends Mover {

    private int tickCounter;
    private int currentKey; // last key pressed/released
    protected Material previousMaterial;
    protected Material currentMaterial;

    public Player(App app, PImage sprite) {

<span class="fc" id="L14">        super(app, sprite);</span>

        // player always begins in the top-left corner of the map
<span class="fc" id="L17">        this.x = 0;</span>
<span class="fc" id="L18">        this.y = 80;</span>
        
        // key is not pressed when game starts
<span class="fc" id="L21">        this.direction = Direction.STATIC;</span>
<span class="fc" id="L22">        this.tickCounter = 0;</span>
<span class="fc" id="L23">    }</span>

    public int getTickCounter() {
<span class="fc" id="L26">        return this.tickCounter;</span>
    }
    public Material getCurrentMaterial() {
<span class="fc" id="L29">        return this.currentMaterial;</span>
    }
    public Material getPreviousMaterial() {
<span class="fc" id="L32">        return this.previousMaterial;</span>
    }

    /* MOVEMENT */

    public void pressUp() {
<span class="nc" id="L38">        this.direction = Direction.UP;</span>
<span class="nc" id="L39">    }</span>
    public void pressDown() {
<span class="nc" id="L41">        this.direction = Direction.DOWN;</span>
<span class="nc" id="L42">    }</span>
    public void pressLeft() {
<span class="nc" id="L44">        this.direction = Direction.LEFT;</span>
<span class="nc" id="L45">    }</span>
    public void pressRight() {
<span class="nc" id="L47">        this.direction = Direction.RIGHT;</span>
<span class="nc" id="L48">    }</span>
    public void release() {
<span class="fc" id="L50">        this.direction = Direction.STATIC;</span>
<span class="fc" id="L51">    }</span>
    public void reset() {
<span class="fc" id="L53">        this.x = 0;</span>
<span class="fc" id="L54">        this.y = 80;</span>
<span class="fc" id="L55">    }</span>
    public void onKeyPress(int currentKey) {
<span class="nc" id="L57">        this.currentKey = currentKey;</span>
<span class="nc" id="L58">    }</span>

    // MAIN METHOD
    // GETS CALLED EVERY FRAME
    // CONTROLS PLAYER MOVEMENT LOGIC
    public void tick() {

<span class="pc bpc" id="L65" title="1 of 2 branches missed.">        if (this.direction == Direction.EMERGENCYSTOP) return;</span>

        // once the player is perfectly on a tile
<span class="pc bpc" id="L68" title="3 of 4 branches missed.">        if (this.tickCounter == 0 || this.tickCounter == 10) {</span>

            // update materials
<span class="fc" id="L71">            Material temp = this.currentMaterial;</span>
<span class="fc" id="L72">            this.currentMaterial = this.app.currentLevel.getMaterialPixel(this.x, this.y); </span>
<span class="fc" id="L73">            this.previousMaterial = temp;</span>

<span class="fc" id="L75">            this.tickCounter = 0;</span>

            ////// RULES FOR CHANGING DIRECTION //////

            // RULES FOR CONCRETE //
<span class="pc bpc" id="L80" title="1 of 2 branches missed.">            if (this.currentMaterial == Material.CONCRETE) {</span>
                // when on concrete the player needs to hold down a key to move
                
<span class="pc bpc" id="L83" title="1 of 2 branches missed.">                if (!app.keyPressed) {</span>
<span class="fc" id="L84">                    this.release();</span>
<span class="nc bnc" id="L85" title="All 2 branches missed.">                } else if (currentKey == 37) {</span>
<span class="nc" id="L86">                    this.pressLeft();</span>
<span class="nc bnc" id="L87" title="All 2 branches missed.">                } else if (currentKey == 38) {</span>
<span class="nc" id="L88">                    this.pressUp();</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">                } else if (currentKey == 39) {</span>
<span class="nc" id="L90">                    this.pressRight();</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">                } else if (currentKey == 40) {</span>
<span class="nc" id="L92">                    this.pressDown();</span>
                }
            }

            // RULES FOR SOIL AND GRASS //
<span class="pc bpc" id="L97" title="2 of 4 branches missed.">            if (this.currentMaterial == Material.SOIL || this.currentMaterial == Material.GRASS) {</span>
                // nothing happens if user presses the opposite direction to current movement
<span class="nc bnc" id="L99" title="All 2 branches missed.">                if (currentKey == 37) {</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">                    if (this.direction != Direction.RIGHT) this.pressLeft();</span>
<span class="nc bnc" id="L101" title="All 2 branches missed.">                } else if (currentKey == 38) {</span>
<span class="nc bnc" id="L102" title="All 2 branches missed.">                    if (this.direction != Direction.DOWN) this.pressUp();</span>
<span class="nc bnc" id="L103" title="All 2 branches missed.">                } else if (currentKey == 39) {</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">                    if (this.direction != Direction.LEFT) this.pressRight();</span>
<span class="nc bnc" id="L105" title="All 2 branches missed.">                } else if (currentKey == 40) {</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">                    if (this.direction != Direction.UP) this.pressDown();</span>
                }
            }

        }

        // player's movement speed is 2 pixels per frame, hence +=/-= 2
        // only move if the player is within the bounds of the game
<span class="pc bpc" id="L114" title="1 of 2 branches missed.">        if (this.direction == Direction.RIGHT) {</span>
<span class="nc bnc" id="L115" title="All 2 branches missed.">            if (this.x &lt; 1260) this.x += 2; </span>
<span class="nc" id="L116">            this.tickCounter++;</span>
<span class="pc bpc" id="L117" title="1 of 2 branches missed.">        } else if (this.direction == Direction.LEFT) {</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">            if (this.x &gt; 0) this.x -= 2;</span>
<span class="nc" id="L119">            this.tickCounter++;</span>
<span class="pc bpc" id="L120" title="1 of 2 branches missed.">        } else if (this.direction == Direction.DOWN) {</span>
<span class="nc bnc" id="L121" title="All 2 branches missed.">            if (this.y &lt; 700) this.y += 2;</span>
<span class="nc" id="L122">            this.tickCounter++;</span>
<span class="pc bpc" id="L123" title="1 of 2 branches missed.">        } else if (this.direction == Direction.UP) {</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">            if (this.y &gt; 80) this.y -= 2;</span>
<span class="nc" id="L125">            this.tickCounter++;</span>
        }

<span class="fc" id="L128">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>